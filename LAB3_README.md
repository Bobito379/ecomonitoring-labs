# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞ 3 - –í–∞—Ä—ñ–∞–Ω—Ç 5
## –í–∏—è–≤–ª–µ–Ω–Ω—è –∞–Ω–æ–º–∞–ª—å–Ω–æ–≥–æ –≤–∏–∫–∏–¥—É (–ù–°) –∑–∞ —á–∞—Å–æ–≤–∏–º —Ä—è–¥–æ–º

### –û–ø–∏—Å –≤–∞—Ä—ñ–∞–Ω—Ç—É
–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è —Å–∏—Å—Ç–µ–º–∏ –≤–∏—è–≤–ª–µ–Ω–Ω—è –∞–Ω–æ–º–∞–ª—å–Ω–∏—Ö –≤–∏–∫–∏–¥—ñ–≤ –∑–∞–±—Ä—É–¥–Ω—é–≤–∞—á—ñ–≤ –ø–æ–≤—ñ—Ç—Ä—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É —á–∞—Å–æ–≤–∏—Ö —Ä—è–¥—ñ–≤.

**–ú–µ—Ç–æ–¥ –¥–µ—Ç–µ–∫—Ü—ñ—ó:**
- –ö–æ–≤–∑–Ω–µ —Å–µ—Ä–µ–¥–Ω—î (Œº_t)
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è (œÉ)
- –ü–æ—Ä—ñ–≥ –∞–Ω–æ–º–∞–ª—ñ—ó: x_t > Œº_t + 3œÉ
- P95 - 95-–π –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—å
- –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –ø–æ–¥—ñ—ó

**–ó–∞–±—Ä—É–¥–Ω—é–≤–∞—á—ñ:**
- PM2.5 (2-200 –º–∫–≥/–º¬≥)
- NO‚ÇÇ (5-400 –º–∫–≥/–º¬≥)
- SO‚ÇÇ (3-200 –º–∫–≥/–º¬≥)
- O‚ÇÉ (10-250 –º–∫–≥/–º¬≥)

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É

### Backend (Node.js/Express/MongoDB)

**–ú–æ–¥–µ–ª—ñ:**
- `models/AnomalyDetection.js` - Mongoose —Å—Ö–µ–º–∞ –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —á–∞—Å–æ–≤–∏—Ö —Ä—è–¥—ñ–≤ —Ç–∞ –∞–Ω–æ–º–∞–ª—ñ–π

**–£—Ç–∏–ª—ñ—Ç–∏:**
- `utils/anomalyCompute.js` - –§—É–Ω–∫—Ü—ñ—ó —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –∞–Ω–æ–º–∞–ª—ñ–π (—á–∏—Å—Ç–∞ –ª–æ–≥—ñ–∫–∞ –±–µ–∑ –ø–æ–±—ñ—á–Ω–∏—Ö –µ—Ñ–µ–∫—Ç—ñ–≤)

**Controllers:**
- `controllers/anomalyDetectionController.js` - –ë—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∞ API

**Routes:**
- `routes/anomalyDetectionRoutes.js` - API endpoints

**Seed:**
- `seedAnomaly.js` - –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Å–∏–Ω—Ç–µ—Ç–∏—á–Ω–∏—Ö —á–∞—Å–æ–≤–∏—Ö —Ä—è–¥—ñ–≤

### Frontend (React/Vite)

**–°—Ç–æ—Ä—ñ–Ω–∫–∏:**
- `pages/AnomalyDetectionPage.jsx` - –û—Å–Ω–æ–≤–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –∑ —Ñ–æ—Ä–º–æ—é —Ç–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏:**
- `components/TimeSeriesChart/TimeSeriesChart.jsx` - SVG-–≥—Ä–∞—Ñ—ñ–∫ —á–∞—Å–æ–≤–æ–≥–æ —Ä—è–¥—É –∑ –º–∞—Ä–∫–µ—Ä–∞–º–∏ –∞–Ω–æ–º–∞–ª—ñ–π

---

## –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –∑–∞–ø—É—Å–∫

### 1. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π

**Backend:**
```bash
cd server
npm install
```

**Frontend:**
```bash
cd react-app
npm install
```

### 2. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è MongoDB

–°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ–∞–π–ª `server/.env`:
```env
MONGODB_URI=mongodb://localhost:27017/ecological_monitoring
PORT=3000
```

### 3. –ó–∞–ø—É—Å–∫ MongoDB
```bash
mongod
```

### 4. –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Ç–µ—Å—Ç–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö
```bash
cd server
npm run seed:anomaly
```

### 5. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä—ñ–≤

**Backend (—Ç–µ—Ä–º—ñ–Ω–∞–ª 1):**
```bash
cd server
npm run dev
```

**Frontend (—Ç–µ—Ä–º—ñ–Ω–∞–ª 2):**
```bash
cd react-app
npm run dev
```

**Frontend –±—É–¥–µ –¥–æ—Å—Ç—É–ø–Ω–∏–π:** http://localhost:5173
**Backend API:** http://localhost:3000/api

---

## API Endpoints

### POST /api/anomaly-detection/detect
–í–∏—è–≤–ª–µ–Ω–Ω—è –∞–Ω–æ–º–∞–ª—ñ–π —É —á–∞—Å–æ–≤–æ–º—É —Ä—è–¥—ñ

**–¢—ñ–ª–æ –∑–∞–ø–∏—Ç—É:**
```json
{
  "stationId": "Station-Kyiv-Center",
  "pollutant": "PM2.5",
  "timeSeries": [
    {"timestamp": "2025-12-10T00:00:00Z", "value": 25.5},
    {"timestamp": "2025-12-10T00:15:00Z", "value": 27.3}
  ],
  "windowSize": 120,
  "thresholdMultiplier": 3,
  "minEventDuration": 10
}
```

**–í—ñ–¥–ø–æ–≤—ñ–¥—å:**
```json
{
  "success": true,
  "data": {
    "id": "...",
    "summary": {
      "totalPoints": 96,
      "anomalyPoints": 15,
      "anomalyEvents": 2,
      "p95Value": 85.5
    },
    "detectedAnomalies": [
      {
        "startTime": "2025-12-10T06:00:00Z",
        "endTime": "2025-12-10T06:45:00Z",
        "duration": 12,
        "maxValue": 150.5,
        "avgValue": 135.2
      }
    ],
    "processedSeries": [...]
  }
}
```

### GET /api/anomaly-detection/
–û—Ç—Ä–∏–º–∞—Ç–∏ –≤—Å—ñ –∑–∞–ø–∏—Å–∏ –∞–Ω–æ–º–∞–ª—ñ–π

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä–∏:**
- `pollutant` - —Ñ—ñ–ª—å—Ç—Ä –∑–∞ –∑–∞–±—Ä—É–¥–Ω—é–≤–∞—á–µ–º
- `stationId` - —Ñ—ñ–ª—å—Ç—Ä –∑–∞ —Å—Ç–∞–Ω—Ü—ñ—î—é

### GET /api/anomaly-detection/:id
–û—Ç—Ä–∏–º–∞—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π –∑–∞–ø–∏—Å –∞–Ω–æ–º–∞–ª—ñ—ó

### GET /api/anomaly-detection/:id/timeseries
–û—Ç—Ä–∏–º–∞—Ç–∏ —á–∞—Å–æ–≤–∏–π —Ä—è–¥ –¥–ª—è –∑–∞–ø–∏—Å—É

### DELETE /api/anomaly-detection/:id
–í–∏–¥–∞–ª–∏—Ç–∏ –∑–∞–ø–∏—Å –∞–Ω–æ–º–∞–ª—ñ—ó

---

## –ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω–∏–π –∞–ø–∞—Ä–∞—Ç

### –ö–æ–≤–∑–Ω–µ —Å–µ—Ä–µ–¥–Ω—î
```
Œº_t = (1/n) √ó Œ£(x_i) –¥–ª—è i –≤—ñ–¥ (t-n+1) –¥–æ t
```

### –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è
```
œÉ = ‚àö[(1/n) √ó Œ£(x_i - Œº)¬≤]
```

### –ü–æ—Ä—ñ–≥ –∞–Ω–æ–º–∞–ª—ñ—ó
```
threshold = Œº_t + k √ó œÉ, –¥–µ k = 3 (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º)
```

### P95 (95-–π –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—å)
```
–ó–Ω–∞—á–µ–Ω–Ω—è, –Ω–∏–∂—á–µ —è–∫–æ–≥–æ –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è 95% –≤—Å—ñ—Ö –≤–∏–º—ñ—Ä—é–≤–∞–Ω—å
```

### –î–µ—Ç–µ–∫—Ü—ñ—è –ø–æ–¥—ñ—ó
–ê–Ω–æ–º–∞–ª—å–Ω–∞ –ø–æ–¥—ñ—è –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è —è–∫ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å —Ç–æ—á–æ–∫, –¥–µ:
- x_t > threshold
- –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å ‚â• minEventDuration

---

## –í–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö

**–í—Ö—ñ–¥–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏:**
- `stationId` - –æ–±–æ–≤'—è–∑–∫–æ–≤–∏–π, string
- `pollutant` - –æ–±–æ–≤'—è–∑–∫–æ–≤–∏–π, –æ–¥–∏–Ω –∑ ['PM2.5', 'NO2', 'SO2', 'O3']
- `timeSeries` - –æ–±–æ–≤'—è–∑–∫–æ–≤–∏–π, –º—ñ–Ω—ñ–º—É–º 24 —Ç–æ—á–∫–∏
- `windowSize` - –æ–ø—Ü—ñ–π–Ω–æ, 10-500 (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: 120)
- `thresholdMultiplier` - –æ–ø—Ü—ñ–π–Ω–æ, 1-10 (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: 3)
- `minEventDuration` - –æ–ø—Ü—ñ–π–Ω–æ, 1-200 —Ö–≤ (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: 10)

**–ß–∞—Å–æ–≤–∏–π —Ä—è–¥:**
- –ö–æ–∂–Ω–∞ —Ç–æ—á–∫–∞ –º—ñ—Å—Ç–∏—Ç—å: `timestamp` —Ç–∞ `value`
- `value` –ø–æ–≤–∏–Ω–Ω–æ –±—É—Ç–∏ ‚â• 0
- –ú—ñ–Ω—ñ–º—É–º 24 —Ç–æ—á–∫–∏ –¥–ª—è –≤–∞–ª—ñ–¥–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É

---

## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è frontend

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –≤–∫–ª–∞–¥–∫—É "–í–∏—è–≤–ª–µ–Ω–Ω—è –∞–Ω–æ–º–∞–ª—ñ–π"
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "üé≤ –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ" –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è —Ñ–æ—Ä–º–∏
3. –ù–∞–ª–∞—à—Ç—É–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∞–Ω–∞–ª—ñ–∑—É:
   - –†–æ–∑–º—ñ—Ä –≤—ñ–∫–Ω–∞ (–∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ç–æ—á–æ–∫ –¥–ª—è –∫–æ–≤–∑–Ω–æ–≥–æ —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ)
   - –ú–Ω–æ–∂–Ω–∏–∫ –ø–æ—Ä–æ–≥—É (–∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –¥–ª—è œÉ)
   - –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –ø–æ–¥—ñ—ó
4. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "üîç –í–∏—è–≤–∏—Ç–∏ –∞–Ω–æ–º–∞–ª—ñ—ó"
5. –ü–µ—Ä–µ–≥–ª—è–¥–∞–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏:
   - –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π –≥—Ä–∞—Ñ—ñ–∫ –∑ –º–∞—Ä–∫–µ—Ä–∞–º–∏ –∞–Ω–æ–º–∞–ª—ñ–π
   - –ö–∞—Ä—Ç–∫–∏ –ø–æ–¥—ñ–π –∑ –¥–µ—Ç–∞–ª—è–º–∏ (—á–∞—Å, —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å, –∑–Ω–∞—á–µ–Ω–Ω—è)
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: P95, –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ–¥—ñ–π, –∑–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∞–Ω–æ–º–∞–ª—å–Ω–∏—Ö —Ç–æ—á–æ–∫

---

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è API

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ñ–∞–π–ª `server/anomaly-tests.http` –∑ REST Client —É VS Code –∞–±–æ —ñ–º–ø–æ—Ä—Ç—É–π—Ç–µ —É Postman/Insomnia.

---

## –©–æ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ

- ‚úÖ Mongoose –º–æ–¥–µ–ª—å –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —á–∞—Å–æ–≤–∏—Ö —Ä—è–¥—ñ–≤ —Ç–∞ –∞–Ω–æ–º–∞–ª—ñ–π
- ‚úÖ –ß–∏—Å—Ç–∞ —Ñ—É–Ω–∫—Ü—ñ—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –∞–Ω–æ–º–∞–ª—ñ–π (–±–µ–∑ –ø–æ–±—ñ—á–Ω–∏—Ö –µ—Ñ–µ–∫—Ç—ñ–≤)
- ‚úÖ API endpoints –∑ –ø–æ–≤–Ω–æ—é –≤–∞–ª—ñ–¥–∞—Ü—ñ—î—é
- ‚úÖ Seed-—Å–∫—Ä–∏–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó —Å–∏–Ω—Ç–µ—Ç–∏—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö
- ‚úÖ React-—Å—Ç–æ—Ä—ñ–Ω–∫–∞ –∑ —Ñ–æ—Ä–º–æ—é –≤–≤–æ–¥—É
- ‚úÖ SVG-–≥—Ä–∞—Ñ—ñ–∫ —á–∞—Å–æ–≤–æ–≥–æ —Ä—è–¥—É –∑ –º–∞—Ä–∫–µ—Ä–∞–º–∏ –∞–Ω–æ–º–∞–ª—ñ–π
- ‚úÖ –ö–Ω–æ–ø–∫–∞ "–ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ" –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è
- ‚úÖ –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤–∏—è–≤–ª–µ–Ω–∏—Ö –ø–æ–¥—ñ–π –∑ –¥–µ—Ç–∞–ª—è–º–∏
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞–Ω–∞–ª—ñ–∑—É (P95, –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ–¥—ñ–π)

---

## –í—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å –≤–∏–º–æ–≥–∞–º –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ—ó —Ä–æ–±–æ—Ç–∏

**–¢–µ–æ—Ä–µ—Ç–∏—á–Ω–∞ –±–∞–∑–∞:**
- –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –º–æ–¥–µ–ª—å –∑ –º–µ—Ç–æ–¥–∏—á–Ω–∏—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π (–í–∞—Ä—ñ–∞–Ω—Ç 5)
- –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω—ñ –º–µ—Ç–æ–¥–∏ (Œº, œÉ, P95)
- –í—Ä–∞—Ö–æ–≤–∞–Ω–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∑ –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ–≤ –∑–∞–≤–¥–∞–Ω–Ω—è

**–¢–µ—Ö–Ω—ñ—á–Ω–∏–π —Å—Ç–µ–∫:**
- ‚úÖ MongoDB - –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —á–∞—Å–æ–≤–∏—Ö —Ä—è–¥—ñ–≤
- ‚úÖ Express - REST API
- ‚úÖ React - —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- ‚úÖ Node.js - —Å–µ—Ä–≤–µ—Ä–Ω–∞ –ª–æ–≥—ñ–∫–∞

**–§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å:**
- ‚úÖ –§–æ—Ä–º–∞ –≤–≤–æ–¥—É –∑ –ø—ñ–¥–∫–∞–∑–∫–∞–º–∏ –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ–≤
- ‚úÖ –í–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö (Joi/custom)
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Å–∏–Ω—Ç–µ—Ç–∏—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö
- ‚úÖ –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ (–≥—Ä–∞—Ñ—ñ–∫ + —Ç–∞–±–ª–∏—Ü—ñ)
- ‚úÖ –Ü—Å—Ç–æ—Ä—ñ—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—ñ–≤ (–∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —É –ë–î)

---

## –ê–≤—Ç–æ—Ä
–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞ –≤–∏–∫–æ–Ω–∞–Ω–∞ –∑–≥—ñ–¥–Ω–æ –∑ –º–µ—Ç–æ–¥–∏—á–Ω–∏–º–∏ –≤–∫–∞–∑—ñ–≤–∫–∞–º–∏
–í–∞—Ä—ñ–∞–Ω—Ç 5: –í–∏—è–≤–ª–µ–Ω–Ω—è –∞–Ω–æ–º–∞–ª—å–Ω–æ–≥–æ –≤–∏–∫–∏–¥—É (–ù–°) –∑–∞ —á–∞—Å–æ–≤–∏–º —Ä—è–¥–æ–º
